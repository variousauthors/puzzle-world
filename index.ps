title Soft Clay
author Ziggy
homepage www.puzzlescript.net
verbose_logging
run_rules_on_level_start

========
OBJECTS
========

Background
lightgreen

Water
#ADD8E6

Player
black orange brown black
12221
13331
.3.3.
.....
.....

PlayerTop
black orange brown black
.....
.....
.....
..1..
.222.

( TODO implement a rolling animation )
Boulder
grey darkgrey lightgray
.220.
22200
02000
10001
.111.

RollingBoulder
grey darkgrey lightgray blue
.2223
22000
00000
00011
.111.

DeepBoulder
black darkblue blue
.111.
12211
12111
01110
.000.

ShallowBoulder
grey darkgrey lightgray
.....
.220.
22200
02000
.....

Rock
grey darkgrey lightgray
.222.
22000
00000
00011
.....

Tree
#44891A brown #54992A #64A93A
.232.
02220
00000
.111.
.....

stump
brown LIGHTBROWN
.111.
.111.
.111.
.000.
.....

LogH
brown lightbrown
.....
00000
00000
00000
.....

LogV
brown lightbrown
.000.
.000.
.000.
.000.
.111.

impulse
pink
....0
.....
.....
.....
.....

sinking
transparent

impulsed
transparent

=======
LEGEND
=======

. = Background
P = Player
b = Boulder
T = tree
o = rock
~ = Water

obstacle = rock or tree or Boulder
log = logH or logV
sink = water
bridge = ShallowBoulder

=======
SOUNDS
=======

================
COLLISIONLAYERS
================

Background
Water
DeepBoulder
ShallowBoulder
RollingBoulder
Player
Boulder
tree
rock
stump
log
impulse
sinking
impulsed
PlayerTop

======
RULES
======

( BUGS )
( should be able to send object over boulder bridge )

( PLAYER )

[ > player | obstacle ] -> [ > player impulse | impulsed obstacle ]

[ > player | water no bridge ] -> [ player | water no bridge ]

( PHYSICS )

[ impulse | impulsed obstacle | sink ] -> [ | > obstacle | sink ]

[ impulse | impulsed obstacle | obstacle ] -> [ | obstacle impulse | impulsed obstacle ] again

( OBJECTS )

( TREE )

( push it over )

( LOG )

( roll them )

( BOULDER )

( BOULDER: ROLLING )
[ impulse | impulsed Boulder | no obstacle ] -> [ | impulsed > Boulder impulse | no obstacle ] again

( BOULDER: STATES )
late [ Boulder sink ] -> [ Boulder sinking sink ]
late [ Boulder sinking no DeepBoulder ] -> [ DeepBoulder ] 
late [ Boulder sinking DeepBoulder ] -> [ DeepBoulder ShallowBoulder ] 

( ROCK )

( ROCK: PUSHING )
[ impulse | impulsed rock | no obstacle ] -> [ | impulsed > rock | no obstacle ] again

( ROCK: STATES )
late [ rock sink ] -> [ rock sinking sink ]
late [ rock sinking no DeepBoulder ] -> [ DeepBoulder ]
late [ rock sinking DeepBoulder ] -> [ DeepBoulder ShallowBoulder ]

( END OBJECTS )

( PHYSICS: AFTER )

( keep the impulsed tag with the moving object )
[ impulsed > obstacle ] -> [ > impulsed > obstacle ]
( stop player from moving into obstacles that were blocked )
[ > player | stationary obstacle ] -> [ player | obstacle ]
( remove impulse after map edge stops obstacle )
[ impulse | impulsed stationary obstacle ] -> [ | obstacle ]


( RENDER )
late up [ no Player | PlayerTop  ] -> [ | ] 
late up [ Player | no PlayerTop  ] -> [ Player | PlayerTop ] 

==============
WINCONDITIONS
==============

=======
LEVELS
=======

..........
......T...
.b..b...o.
..P...~~..
T....~~~..
.b..~~~...
...~~.....
..........
..........
..........
